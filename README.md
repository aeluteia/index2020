# Ranking Digital Rights - 2020 Corporate Accountability Index

> Surveying internet and telecommunications companies on user privacy and freedom of expression

## Setup Development Environment

Make sure to have a recent version of [NodeJS](https://nodejs.org). This project is developed using NodeJS 12. Further, install the [Yarn package manager](https://yarnpkg.com/).

To fetch the editorial content from Google Docs the authentication token for Google Drive has to be placed in the `./.auth.json` file in the repository root.

### Dependencies

Install all dependencies,

```sh
yarn install
```

### Development server

```sh
yarn install
yarn dev
```

Open [http://localhost:3000/index2020](http://localhost:3000/index2020) with your browser to see the result.

### Verify

```sh
yarn verify
```

This will run `yarn lint` and `yarn type-check`.

### Storybook

There is a [Storybook](https://storybook.js.org/) for UI component development.

```sh
yarn storybook
```

The Storybook is accessible at `http://localhost:6006`.

### Deploy to remote

The [`.scripts/deploy.sh`](.scripts/deploy.sh) script can be used to deploy the website to the remote. As a default it deploys to the staging area. Use the `-p` flag to deploy to production instead.

```sh
yarn deploy
# or to deploy to production
yarn deploy -p
```

### Navigation

The navigation structure is defined as a JSON file in [`data/navigation.json`](data/navigation.json). This file generated by calling `yarn navigation`, which loads the companies and indicators from CSV, and dynamically generates the final menu structure. Edit [`src/navigation.ts`](src/navigation.ts) to modify the menu template. The menu structure can be defined recursively, but the `Navigation` component will render menu nodes only 2 levels deep.

## `indexctl`

The `bin/indexctl.ts` script provides operational support for the index 2020. The command can be invoked with `yarn indexctl`. See all available commands by calling `yarn indexctl -h`.
